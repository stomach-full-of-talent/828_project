app:
  description: æŒ‰å¹´åº¦åŸ¹è®­è®¡åˆ’ï¼Œè‡ªåŠ¨ç”Ÿæˆæœˆåº¦åŸ¹è®­è®¡åˆ’å¹¶æŒ‰æ—¶å‘å¸ƒåŸ¹è®­é€šçŸ¥
  icon: ğŸ¤–
  icon_background: '#FFEAD5'
  mode: advanced-chat
  name: äººåŠ›èµ„æºéƒ¨-æœˆåº¦åŸ¹è®­è®¡åˆ’
  use_icon_as_answer_icon: false
dependencies:
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: langgenius/openai_api_compatible:0.0.16@77274df8fe2632cac66bfd153fcc75aa5e96abbe92b5c611b8984ad9f4cd4457
kind: app
version: 0.3.1
workflow:
  conversation_variables: []
  environment_variables: []
  features:
    file_upload:
      allowed_file_extensions:
      - .JPG
      - .JPEG
      - .PNG
      - .GIF
      - .WEBP
      - .SVG
      allowed_file_types:
      - image
      allowed_file_upload_methods:
      - local_file
      - remote_url
      enabled: false
      fileUploadConfig:
        audio_file_size_limit: 50
        batch_count_limit: 15
        file_size_limit: 200
        image_file_size_limit: 10
        video_file_size_limit: 100
        workflow_file_upload_limit: 10
      image:
        enabled: false
        number_limits: 3
        transfer_methods:
        - local_file
        - remote_url
      number_limits: 3
    opening_statement: è¿™æ˜¯ä¸€ä¸ªç”Ÿæˆæœˆåº¦åŸ¹è®­è®¡åˆ’çš„AIåŠ©æ‰‹ã€‚è¯·è¾“å…¥æ‚¨çš„éƒ¨é—¨å’Œæ‚¨æƒ³è¦çš„åŸ¹è®­è®¡åˆ’ç±»å‹ã€‚
    retriever_resource:
      enabled: true
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions: []
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ''
      voice: ''
  graph:
    edges:
    - data:
        sourceType: llm
        targetType: answer
      id: llm-answer
      source: llm
      sourceHandle: source
      target: answer
      targetHandle: target
      type: custom
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: start
        targetType: if-else
      id: 1753251533020-source-1754637368549-target
      source: '1753251533020'
      sourceHandle: source
      target: '1754637368549'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: knowledge-retrieval
      id: 1754637368549-true-1753251877701-target
      source: '1754637368549'
      sourceHandle: 'true'
      target: '1753251877701'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: if-else
        targetType: answer
      id: 1754637368549-false-1754637485126-target
      selected: false
      source: '1754637368549'
      sourceHandle: 'false'
      target: '1754637485126'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: answer
        targetType: llm
      id: 1754637485126-source-1754637495316-target
      source: '1754637485126'
      sourceHandle: source
      target: '1754637495316'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: llm
        targetType: code
      id: 1754637495316-source-1754637614782-target
      source: '1754637495316'
      sourceHandle: source
      target: '1754637614782'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: code
        targetType: if-else
      id: 1754637614782-source-1754637648376-target
      source: '1754637614782'
      sourceHandle: source
      target: '1754637648376'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: knowledge-retrieval
      id: 1754637648376-true-1753251877701-target
      source: '1754637648376'
      sourceHandle: 'true'
      target: '1753251877701'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: if-else
        targetType: llm
      id: 1754637648376-false-1754637678344-target
      source: '1754637648376'
      sourceHandle: 'false'
      target: '1754637678344'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: llm
        targetType: answer
      id: 1754637678344-source-1754637708518-target
      source: '1754637678344'
      sourceHandle: source
      target: '1754637708518'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: code
        targetType: llm
      id: 1755678692458-source-llm-target
      source: '1755678692458'
      sourceHandle: source
      target: llm
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: knowledge-retrieval
        targetType: code
      id: 1753251877701-source-1755678692458-target
      source: '1753251877701'
      sourceHandle: source
      target: '1755678692458'
      targetHandle: target
      type: custom
      zIndex: 0
    nodes:
    - data:
        desc: ''
        selected: false
        title: å¼€å§‹
        type: start
        variables:
        - label: è®°å¿†
          max_length: 48
          options:
          - æ˜¯
          - å¦
          required: true
          type: select
          variable: memory
      height: 90
      id: '1753251533020'
      position:
        x: 30
        y: 263
      positionAbsolute:
        x: 30
        y: 263
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: true
          variable_selector:
          - '1753251877701'
          - result
        desc: ''
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: /home/user/Desktop/MODELFILE/Qwen3-30B-A3B-think-2507
          provider: langgenius/openai_api_compatible/openai_api_compatible
        prompt_template:
        - id: e117a4ad-8439-4580-b722-357dcd75f592
          role: system
          text: "è¯­è¨€  \nå°†{{#1755678692458.result#}}çš„å†…å®¹å…¨éƒ¨ç¿»è¯‘æˆä¸­æ–‡ã€‚  \nè¯·å…¨ç¨‹ä½¿ç”¨ä¸­æ–‡è¿›è¡Œæ€è€ƒï¼Œå¹¶ä»¥ä¸­æ–‡è¾“å‡ºç­”æ¡ˆã€‚\
            \  \n\nè§’è‰²  \nä½ çš„å”¯ä¸€èŒè´£æ˜¯å°†{{#1755678692458.result#}}ä¸­çš„åºå·æ›¿æ¢ä¸ºçŸ¥è¯†åº“ä¸­å¯¹åº”çš„åºå·ã€‚  \n\n\
            æ‰«æ{{#1755678692458.result#}}ï¼Œå¹¶å°†è¡¨æ ¼ä¸­çš„æ¯ä¸€è¡Œä¸çŸ¥è¯†åº“ç‰‡æ®µï¼ˆä½äº{{#context#}}ä¸­ï¼‰è¿›è¡ŒåŒ¹é…ã€‚  \n\
            \nä»…å…³æ³¨{{#1755678692458.result#}}ä¸­çš„è¡¨æ ¼ï¼š  \n1. å°†è¡¨æ ¼ä¸­çš„åºå·æ›¿æ¢ä¸ºä½ åœ¨ä¸Šä¸‹æ–‡ä¸­æ‰¾åˆ°çš„æ­£ç¡®åºå·ã€‚ä¸ºè¡¨æ ¼ä¸­çš„æ‰€æœ‰15ä¸ªé¡¹ç›®æ‰§è¡Œæ­¤æ“ä½œã€‚\
            \  \n2. å¯¹äºæ‰€æœ‰15é—¨è¯¾ç¨‹çš„â€œæœˆä»½â€åˆ—ï¼Œç¬¬ä¸€è¡Œæ ‡è®°ä¸ºâ€œä¸€æœˆâ€ï¼Œç¬¬äºŒè¡Œæ ‡è®°ä¸ºâ€œäºŒæœˆâ€ï¼Œç¬¬ä¸‰è¡Œæ ‡è®°ä¸ºâ€œä¸‰æœˆâ€ï¼Œä¾æ­¤ç±»æ¨ï¼Œç›´è‡³â€œåäºŒæœˆâ€ã€‚ç„¶åé‡æ–°ä»â€œä¸€æœˆâ€å¼€å§‹ï¼Œå› ä¸ºæœˆå†æ˜¯å¾ªç¯çš„ã€‚"
        selected: true
        title: ç”ŸæˆåŸ¹è®­è®¡åˆ’å™¨
        type: llm
        variables: []
        vision:
          enabled: false
      height: 90
      id: llm
      position:
        x: 3241
        y: 263
      positionAbsolute:
        x: 3241
        y: 263
      selected: true
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: '{{#llm.text#}}'
        desc: ''
        selected: false
        title: å›ç­”
        type: answer
        variables: []
      height: 105
      id: answer
      position:
        x: 3575
        y: 263
      positionAbsolute:
        x: 3575
        y: 263
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        dataset_ids:
        - tDj5h3rdLXA+xR27lVGzaxH2SnM4CVTNd4cZ19MWa3qLxh/2k1zXM9SNOAZFqjjk
        desc: ''
        multiple_retrieval_config:
          reranking_enable: false
          reranking_mode: reranking_model
          reranking_model:
            model: /home/user/Desktop/MODELFILE/bge-reranker-v2-m3
            provider: langgenius/openai_api_compatible/openai_api_compatible
          score_threshold: null
          top_k: 152
        query_variable_selector:
        - '1753251533020'
        - sys.query
        retrieval_mode: multiple
        selected: false
        title: çŸ¥è¯†æ£€ç´¢ç³»ç»Ÿ
        type: knowledge-retrieval
      height: 92
      id: '1753251877701'
      position:
        x: 2309.165309380729
        y: 263
      positionAbsolute:
        x: 2309.165309380729
        y: 263
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: is
            id: 640803da-038e-4382-87e1-65460e00ce6b
            value: å¦
            varType: string
            variable_selector:
            - '1753251533020'
            - memory
          id: 'true'
          logical_operator: and
        desc: ''
        selected: false
        title: IF/ELSE
        type: if-else
      height: 126
      id: '1754637368549'
      position:
        x: 364
        y: 263
      positionAbsolute:
        x: 364
        y: 263
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: æ‚¨å·²å¼€å¯ä¸Šä¸‹æ–‡è®°å¿†åŠŸèƒ½ï¼Œå›ç­”æ—¶é•¿ä¼šæœ‰æ‰€å¢åŠ ï¼Œè¯·è€å¿ƒç­‰å¾…ã€‚å¦‚éœ€å…³é—­è®°å¿†åŠŸèƒ½ï¼Œè¯·ç‚¹å‡»å·¦ä¸Šè§’å¼€å¯æ–°å¯¹è¯~
        desc: ''
        selected: false
        title: å›ç­”
        type: answer
        variables: []
      height: 134
      id: '1754637485126'
      position:
        x: 880
        y: 379
      positionAbsolute:
        x: 880
        y: 379
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        memory:
          query_prompt_template: ç”¨æˆ·é—®é¢˜ï¼š{{#sys.query#}}
          role_prefix:
            assistant: ''
            user: ''
          window:
            enabled: false
            size: 50
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: /home/user/Desktop/MODELFILE/Qwen3-30B-A3B-think-2507
          provider: langgenius/openai_api_compatible/openai_api_compatible
        prompt_template:
        - id: 7e11ce3f-3d16-425e-addb-40de1afb1771
          role: system
          text: '#### **# æ ¸å¿ƒä»»åŠ¡**

            ä½ çš„ä»»åŠ¡æ˜¯ä½œä¸ºä¸€ä¸ªæ™ºèƒ½åˆ†ç±»å™¨ã€‚åˆ†æç»™å®šçš„ `[è®°å¿†çª—å£]` (å³ä¸Šä¸‹æ–‡) å’Œ `[ç”¨æˆ·é—®é¢˜]`ï¼Œåˆ¤æ–­è¯¥é—®é¢˜æ˜¯å¦**å¼ºä¾èµ–**äº`[è®°å¿†çª—å£]`æ¥ç”Ÿæˆä¸€ä¸ªå‡†ç¡®ã€è¿è´¯ä¸”ç¬¦åˆç”¨æˆ·æ„å›¾çš„å›ç­”ã€‚

            Â 

            ---

            Â 

            #### **# è¾“å…¥å®šä¹‰**

            *Â Â  `[è®°å¿†çª—å£]`ï¼šä»£è¡¨ä¹‹å‰çš„å¯¹è¯å†å²æˆ–èƒŒæ™¯ä¿¡æ¯ã€‚

            *Â Â  `[ç”¨æˆ·é—®é¢˜]`ï¼šä»£è¡¨ç”¨æˆ·å½“å‰æå‡ºçš„é—®é¢˜ã€‚

            Â 

            ---

            Â 

            #### **# åˆ¤æ–­è§„åˆ™**

            Â 

            **é¦–è¦è§„åˆ™ï¼š**

            *Â Â  å¦‚æœ `[è®°å¿†çª—å£]` ä¸ºç©ºï¼Œ**å¿…é¡»**è¾“å‡º "no"ã€‚

            Â 

            **ç‰¹æ®ŠæŒ‡ä»¤è¦†ç›–ï¼š**

            *Â Â  å¦‚æœ `[ç”¨æˆ·é—®é¢˜]` ä¸­æ˜ç¡®åŒ…å«â€œæ— éœ€æ£€ç´¢çŸ¥è¯†åº“â€æˆ–ç±»ä¼¼è¡¨è¿°ï¼Œ**å¿…é¡»**è¾“å‡º "yes"ã€‚

            Â 

            **å¦‚æœæ»¡è¶³ä»¥ä¸‹ä»»ä¸€æ¡ä»¶ï¼Œè¾“å‡º "yes" (ä»£è¡¨â€œä¾èµ–ä¸Šä¸‹æ–‡â€)ï¼š**

            Â 

            1.Â  **ç›´æ¥å¼•ç”¨ä¸æ˜¾å¼æŒ‡ä»¤**ï¼šé—®é¢˜ç›´æ¥è¯¢é—®ã€å¼•ç”¨ `[è®°å¿†çª—å£]` çš„å†…å®¹ï¼Œæˆ–åŒ…å«æ˜ç¡®æŒ‡ä»¤è¦æ±‚åŸºäºä¸Šä¸‹æ–‡è¿›è¡Œæ“ä½œã€‚

            Â Â Â  *Â Â  **å…³é”®è¯ç¤ºä¾‹**ï¼šâ€œæ ¹æ®ä¸Šé¢è¯´çš„â€ã€â€œæ€»ç»“ä¸€ä¸‹â€ã€â€œç»§ç»­â€ã€â€œé‚£è¿™ä¸ªå‘¢ï¼Ÿâ€ã€â€œè¯¦ç»†è¯´è¯´â€ã€â€œä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿâ€

            Â 

            2.Â  **ä¸Šä¸‹æ–‡å»¶ç»­ä¸æ·±åŒ–**ï¼šé—®é¢˜æ˜¯ `[è®°å¿†çª—å£]` è¯é¢˜çš„è‡ªç„¶å»¶ç»­ã€è¿½é—®ã€æ¯”è¾ƒã€è¦æ±‚ä¸¾ä¾‹ã€æˆ–è¿›è¡Œæ¨æ–­ã€‚å³ä½¿æ²¡æœ‰æ˜ç¡®çš„æŒ‡ä»£è¯ï¼Œé€»è¾‘ä¸Šä¹Ÿç´§å¯†ç›¸è¿ã€‚

            Â Â Â  *Â Â  **ç¤ºä¾‹**ï¼š

            Â Â Â Â Â Â Â  *Â Â  è®°å¿†çª—å£ï¼šâ€œè‹¹æœå…¬å¸å‘å¸ƒäº†æ–°æ¬¾iPhoneã€‚â€

            Â Â Â Â Â Â Â  *Â Â  ç”¨æˆ·é—®é¢˜ï¼šâ€œå®ƒçš„æ‘„åƒå¤´æœ‰å¤šå°‘åƒç´ ï¼Ÿâ€

            Â 

            3.Â  **å¯»æ±‚ç›¸å…³æ›¿ä»£æ–¹æ¡ˆ**ï¼šé—®é¢˜åœ¨æ¢è®¨ä¸ `[è®°å¿†çª—å£]` ä¸»é¢˜ç›¸å…³çš„å…¶ä»–é€‰é¡¹ã€è§£å†³æ–¹æ¡ˆæˆ–å¯èƒ½æ€§ã€‚

            Â Â Â  *Â Â  **ç¤ºä¾‹**ï¼š

            Â Â Â Â Â Â Â  *Â Â  è®°å¿†çª—å£ï¼šâ€œAæ–¹æ¡ˆçš„ä¼˜ç‚¹æ˜¯æˆæœ¬ä½ã€‚â€

            Â Â Â Â Â Â Â  *Â Â  ç”¨æˆ·é—®é¢˜ï¼šâ€œé‚£Bæ–¹æ¡ˆå‘¢ï¼Ÿâ€

            Â 

            **å¦‚æœæ»¡è¶³ä»¥ä¸‹ä»»ä¸€æ¡ä»¶ï¼Œè¾“å‡º "no" (ä»£è¡¨â€œä¸ä¾èµ–ä¸Šä¸‹æ–‡â€)ï¼š**

            Â 

            1.Â  **å¼€å¯å…¨æ–°è¯é¢˜**ï¼šé—®é¢˜ä¸ `[è®°å¿†çª—å£]` çš„ä¸»é¢˜ã€å®ä½“ã€æ„å›¾å®Œå…¨æ— å…³ã€‚

            Â Â Â  *Â Â  **ç¤ºä¾‹**ï¼š

            Â Â Â Â Â Â Â  *Â Â  è®°å¿†çª—å£ï¼šâ€œæˆ‘ä»¬æ¥è®¨è®ºä¸€ä¸‹å…¨çƒæ°”å€™å˜åŒ–ã€‚â€

            Â Â Â Â Â Â Â  *Â Â  ç”¨æˆ·é—®é¢˜ï¼šâ€œç»™æˆ‘è®²ä¸ªç¬‘è¯å§ã€‚â€

            Â 

            2.Â  **å¯ç‹¬ç«‹å›ç­”çš„é€šç”¨é—®é¢˜**ï¼šé—®é¢˜è™½ç„¶å¯èƒ½ä¸ä¸Šä¸‹æ–‡ä¸»é¢˜æœ‰å¾®å¼±å…³è”ï¼Œä½†å®ƒæ˜¯ä¸€ä¸ªå¯ä»¥ç‹¬ç«‹ã€å®Œæ•´å›ç­”çš„é€šç”¨çŸ¥è¯†æ€§é—®é¢˜ï¼Œæ— éœ€ä¾èµ– `[è®°å¿†çª—å£]`
            çš„å…·ä½“ä¿¡æ¯ã€‚

            Â Â Â  *Â Â  **ç¤ºä¾‹**ï¼š

            Â Â Â Â Â Â Â  *Â Â  è®°å¿†çª—å£ï¼šâ€œæˆ‘æ­£åœ¨çœ‹å…³äºç‰¹æ–¯æ‹‰Model Yçš„è¯„æµ‹ã€‚â€

            Â Â Â Â Â Â Â  *Â Â  ç”¨æˆ·é—®é¢˜ï¼šâ€œç‰¹æ–¯æ‹‰æ˜¯å“ªä¸ªå›½å®¶çš„å…¬å¸ï¼Ÿâ€ (è¿™ä¸ªé—®é¢˜æœ¬èº«æ˜¯ç‹¬ç«‹çš„ï¼Œä¸éœ€è¦è¯„æµ‹çš„å…·ä½“å†…å®¹)

            Â 

            ---

            Â 

            #### **# æ¡ˆä¾‹å­¦ä¹ **

            Â 

            *Â Â  **æ¡ˆä¾‹ 1 (yes)**

            Â Â Â  *Â Â  `[è®°å¿†çª—å£]`ï¼šâ€œAIçš„å‘å±•ä¸ºç¤¾ä¼šå¸¦æ¥äº†è®¸å¤šä¾¿åˆ©ï¼Œä¾‹å¦‚åœ¨åŒ»ç–—é¢†åŸŸçš„æ™ºèƒ½è¯Šæ–­å’Œé‡‘èé¢†åŸŸçš„é£é™©æ§åˆ¶ã€‚â€

            Â Â Â  *Â Â  `[ç”¨æˆ·é—®é¢˜]`ï¼šâ€œå®ƒåœ¨æœªæ¥è¿˜å¯èƒ½æœ‰å“ªäº›åº”ç”¨ï¼Ÿâ€

            Â Â Â  *Â Â  **åˆ†æ**ï¼šå±äºâ€œä¸Šä¸‹æ–‡å»¶ç»­ä¸æ·±åŒ–â€ã€‚

            Â 

            *Â Â  **æ¡ˆä¾‹ 2 (yes)**

            Â Â Â  *Â Â  `[è®°å¿†çª—å£]`ï¼šâ€œé…æ–™ï¼šé¢ç²‰500å…‹ï¼Œæ°´250å…‹ï¼Œé…µæ¯5å…‹ï¼Œç³–10å…‹ã€‚é¦–å…ˆå°†é…µæ¯å’Œç³–æº¶äºæ¸©æ°´ä¸­ã€‚â€

            Â Â Â  *Â Â  `[ç”¨æˆ·é—®é¢˜]`ï¼šâ€œç„¶åå‘¢ï¼Ÿâ€

            Â Â Â  *Â Â  **åˆ†æ**ï¼šå±äºâ€œç›´æ¥å¼•ç”¨ä¸æ˜¾å¼æŒ‡ä»¤â€ã€‚

            Â 

            *Â Â  **æ¡ˆä¾‹ 3 (no)**

            Â Â Â  *Â Â  `[è®°å¿†çª—å£]`ï¼šâ€œæˆ‘è®¡åˆ’ä¸‹å‘¨å»åŒ—äº¬æ—…æ¸¸ï¼Œæœ‰ä»€ä¹ˆæ¨èçš„æ™¯ç‚¹å—ï¼Ÿâ€

            Â Â Â  *Â Â  `[ç”¨æˆ·é—®é¢˜]`ï¼šâ€œæ¨èä¸€éƒ¨æœ€è¿‘å¥½çœ‹çš„ç”µå½±ã€‚â€

            Â Â Â  *Â Â  **åˆ†æ**ï¼šå±äºâ€œå¼€å¯å…¨æ–°è¯é¢˜â€ã€‚

            Â 

            *Â Â  **æ¡ˆä¾‹ 4 (no)**

            Â Â Â  *Â Â  `[è®°å¿†çª—å£]`ï¼šâ€œiPhone 15 Pro Maxé‡‡ç”¨äº†A17 ProèŠ¯ç‰‡ï¼Œæ€§èƒ½éå¸¸å¼ºå¤§ã€‚â€

            Â Â Â  *Â Â  `[ç”¨æˆ·é—®é¢˜]`ï¼šâ€œè‹¹æœå…¬å¸çš„è‚¡ä»·æ˜¯å¤šå°‘ï¼Ÿâ€

            Â Â Â  *Â Â  **åˆ†æ**ï¼šå±äºâ€œå¯ç‹¬ç«‹å›ç­”çš„é€šç”¨é—®é¢˜â€ã€‚è™½ç„¶éƒ½å’Œè‹¹æœæœ‰å…³ï¼Œä½†å›ç­”è‚¡ä»·é—®é¢˜æ— éœ€çŸ¥é“èŠ¯ç‰‡ä¿¡æ¯ã€‚

            Â 

            *Â Â  **æ¡ˆä¾‹ 5 (no)**

            Â Â Â  *Â Â  `[è®°å¿†çª—å£]`ï¼š (ç©º)

            Â Â Â  *Â Â  `[ç”¨æˆ·é—®é¢˜]`ï¼šâ€œä½ å¥½ã€‚â€

            Â Â Â  *Â Â  **åˆ†æ**ï¼šâ€œé¦–è¦è§„åˆ™â€ã€‚

            Â 

            ---

            Â 

            #### **# è¾“å‡ºè¦æ±‚**

            *Â Â  ä¸¥æ ¼éµå¾ªä¸Šè¿°è§„åˆ™ï¼Œä»…è¾“å‡º "yes" æˆ– "no"ã€‚

            *Â Â  ç¦æ­¢æ·»åŠ ä»»ä½•è§£é‡Šã€ç†ç”±æˆ–å…¶ä»–æ— å…³å­—ç¬¦ã€‚'
        selected: false
        title: åˆ¤æ–­æ˜¯å¦éœ€è¦æ ¹æ®ä¸Šä¸‹æ–‡çª—å£å›ç­”
        type: llm
        variables: []
        vision:
          enabled: false
      height: 90
      id: '1754637495316'
      position:
        x: 1216.4872873237032
        y: 379
      positionAbsolute:
        x: 1216.4872873237032
        y: 379
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "\nimport re\ndef main(arg1: str) -> dict:\n    clean_answer = re.sub(r'<think[^>]*>.*?</think>','',arg1,flags=re.DOTALL)\n\
          \    final_answer = re.sub(r'^\\n+','',clean_answer)\n    return {\n   \
          \     \"result\": final_answer,\n    }\n"
        code_language: python3
        desc: ''
        outputs:
          result:
            children: null
            type: string
        selected: false
        title: æ€è€ƒç§»é™¤
        type: code
        variables:
        - value_selector:
          - '1754637495316'
          - text
          value_type: string
          variable: arg1
      height: 54
      id: '1754637614782'
      position:
        x: 1548
        y: 379
      positionAbsolute:
        x: 1548
        y: 379
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: is
            id: 56f24b2e-8b02-4838-ad08-51997c107b7b
            value: 'no'
            varType: string
            variable_selector:
            - '1754637614782'
            - result
          id: 'true'
          logical_operator: and
        desc: ''
        selected: false
        title: IF/ELSE 2
        type: if-else
      height: 126
      id: '1754637648376'
      position:
        x: 1882
        y: 379
      positionAbsolute:
        x: 1882
        y: 379
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        memory:
          query_prompt_template: é—®é¢˜å¦‚ä¸‹ï¼š{{#sys.query#}}
          role_prefix:
            assistant: ''
            user: ''
          window:
            enabled: false
            size: 50
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: /home/user/Desktop/MODELFILE/Qwen3-30B-A3B-think-2507
          provider: langgenius/openai_api_compatible/openai_api_compatible
        prompt_template:
        - id: 7e4d3370-c4ab-47fc-854a-8d04deb1353b
          role: system
          text: "## æ ¸å¿ƒä»»åŠ¡\nä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹é€»è¾‘å’Œä¿¡æ¯æºä¼˜å…ˆçº§ï¼Œç”Ÿæˆä¸€ä¸ªä¸ç”¨æˆ·é—®é¢˜é«˜åº¦ç›¸å…³ã€å‡†ç¡®ä¸”è¿è´¯çš„å›ç­”ã€‚\n\n## ä¿¡æ¯æºä¼˜å…ˆçº§\n1.\
            \  **è®°å¿†çª—å£å†…å®¹ï¼ˆæœ€é«˜ï¼‰**\n2.  **ï¼ˆå¯é€‰ï¼‰å¤–éƒ¨çŸ¥è¯†åº“**\n3.  **æ¨¡å‹å†…ç½®çŸ¥è¯†ï¼ˆæœ€ä½ï¼Œç”¨äºè¡¥å……å’Œæ¶¦è‰²ï¼‰**\n\n##\
            \ æ‰§è¡Œé€»è¾‘ (IF-ELSEç»“æ„)\n**IF** ç”¨æˆ·æ˜ç¡®è¡¨ç¤ºâ€œæ— éœ€æ£€ç´¢çŸ¥è¯†åº“â€ï¼š\n    *   **THEN** æ‰§è¡Œã€**æµç¨‹Aï¼šæ— çŸ¥è¯†åº“æ£€ç´¢**ã€‘ã€‚\n\
            **ELSE** (é»˜è®¤æƒ…å†µ):\n    *   **THEN** æ‰§è¡Œã€**æµç¨‹Bï¼šæ ‡å‡†æ£€ç´¢**ã€‘ã€‚\n\n---\n### ã€æµç¨‹Aï¼šæ— çŸ¥è¯†åº“æ£€ç´¢ã€‘\n\
            1.  **åˆ†æ**ï¼šä»…åˆ†æâ€œè®°å¿†çª—å£å†…å®¹â€ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ã€‚\n2.  **æ•´åˆ**ï¼šä»¥â€œè®°å¿†çª—å£å†…å®¹â€ä¸ºæ ¸å¿ƒï¼Œç»“åˆæ¨¡å‹å†…ç½®çŸ¥è¯†è¿›è¡Œå›ç­”ã€‚\n\
            3.  **ç”Ÿæˆ**ï¼šç”Ÿæˆç›´æ¥å›åº”ç”¨æˆ·é—®é¢˜çš„ç­”æ¡ˆã€‚\n\n### ã€æµç¨‹Bï¼šæ ‡å‡†æ£€ç´¢ã€‘\n1.  **åˆ†æ**ï¼šåˆ†æâ€œè®°å¿†çª—å£å†…å®¹â€ã€â€œå¤–éƒ¨çŸ¥è¯†åº“â€ä¸­çš„æ‰€æœ‰ç›¸å…³ä¿¡æ¯ã€‚\n\
            2.  **æ•´åˆ**ï¼š\n    *   ä»¥â€œè®°å¿†çª—å£å†…å®¹â€ä¸ºæœ€é«˜ä¼˜å…ˆçº§ä¿¡æ¯ï¼Œæ•´åˆæ‰€æœ‰æ¥æºçš„ä¿¡æ¯ã€‚\n    *   å¦‚æœä¿¡æ¯æºä¹‹é—´å­˜åœ¨å†²çªï¼Œä¼˜å…ˆé‡‡ä¿¡â€œè®°å¿†çª—å£å†…å®¹â€ã€‚\n\
            3.  **ç”Ÿæˆ**ï¼šç»“åˆæ¨¡å‹å†…ç½®çŸ¥è¯†ï¼Œç”Ÿæˆä¸€ä¸ªè¿è´¯ã€å‡†ç¡®ä¸”ç›´æ¥å›åº”ç”¨æˆ·é—®é¢˜çš„ç­”æ¡ˆã€‚"
        selected: false
        title: è®°å¿†å¤§æ¨¡å‹
        type: llm
        variables: []
        vision:
          enabled: false
      height: 90
      id: '1754637678344'
      position:
        x: 2641
        y: 408
      positionAbsolute:
        x: 2641
        y: 408
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: '{{#1754637678344.text#}}'
        desc: ''
        selected: false
        title: å›ç­”
        type: answer
        variables: []
      height: 105
      id: '1754637708518'
      position:
        x: 2975
        y: 408
      positionAbsolute:
        x: 2975
        y: 408
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "import re\nimport json\nfrom collections import defaultdict\nfrom typing\
          \ import List, Dict, Any, Union\n\ndef extract_courses_from_metadata(metadata_list:\
          \ List[Dict]) -> List[Dict]:\n    \"\"\"\n    Extract course information\
          \ from Dify metadata format.\n    \"\"\"\n    courses = []\n    \n    for\
          \ item in metadata_list:\n        try:\n            content = item.get('content',\
          \ '')\n            \n            if 'åºå·' in content and 'è¯¾ç¨‹åç§°' in content:\n\
          \                course_entries = content.strip().split('\\n')\n       \
          \         \n                for entry in course_entries:\n             \
          \       try:\n                        pattern = r'\\\"([^\\\"]+)\\\":\\\"\
          ([^\\\"]*)\\\"'\n                        matches = re.findall(pattern, entry)\n\
          \                        \n                        course_data = {}\n  \
          \                      for key, value in matches:\n                    \
          \        clean_key = key.strip().replace('\\\"', '')\n                 \
          \           clean_value = value.strip().replace('\\\"', '')\n          \
          \                  course_data[clean_key] = clean_value\n              \
          \          \n                        if course_data:\n                 \
          \           courses.append(course_data)\n                            \n\
          \                    except Exception as e:\n                        print(f\"\
          Error parsing entry: {entry}\")\n                        continue\n    \
          \        \n        except Exception as e:\n            print(f\"Error processing\
          \ metadata item: {item.get('title', 'Unknown')}\")\n            continue\n\
          \    \n    return courses\n\ndef preprocess_and_filter_courses(metadata_list:\
          \ List[Dict], user_query: str) -> List[Dict]:\n    \"\"\"\n    Code-based\
          \ preprocessing and broad filtering\n    Returns relevant courses while\
          \ preserving all original data\n    \"\"\"\n    # Extract all courses from\
          \ metadata\n    all_courses = extract_courses_from_metadata(metadata_list)\n\
          \    \n    if not all_courses:\n        return []\n    \n    if not user_query\
          \ or user_query.strip() == \"\":\n        # Return all courses if no query,\
          \ but limit to reasonable number\n        return all_courses[:30]  # Increased\
          \ to 30 to allow for 12-month selection\n    \n    # Basic keyword matching\
          \ (broad filter)\n    query_lower = user_query.lower()\n    query_keywords\
          \ = [word for word in query_lower.split() if len(word) > 2]\n    \n    relevant_courses\
          \ = []\n    \n    for course in all_courses:\n        relevance_score =\
          \ 0\n        \n        # Course name match (highest weight)\n        course_name\
          \ = course.get('è¯¾ç¨‹åç§°', '').lower()\n        for keyword in query_keywords:\n\
          \            if keyword in course_name:\n                relevance_score\
          \ += 30\n                break\n        \n        # Department/audience\
          \ match\n        audience = course.get('åŸ¹è®­å¯¹è±¡', '').lower() + ' ' + course.get('åŸ¹è®­å¯¹è±¡1',\
          \ '').lower()\n        for keyword in query_keywords:\n            if keyword\
          \ in audience:\n                relevance_score += 20\n                break\n\
          \        \n        # Trainer match\n        trainer = course.get('åŸ¹è®­è®²å¸ˆ',\
          \ '').lower()\n        for keyword in query_keywords:\n            if keyword\
          \ in trainer:\n                relevance_score += 15\n                break\n\
          \        \n        # Category match\n        category = course.get('ç±»åˆ«',\
          \ '').lower()\n        for keyword in query_keywords:\n            if keyword\
          \ in category:\n                relevance_score += 10\n                break\n\
          \        \n        # Year match\n        year = course.get('å¹´åº¦', '').lower()\n\
          \        for keyword in query_keywords:\n            if keyword in year:\n\
          \                relevance_score += 5\n                break\n        \n\
          \        # If no keyword matches, check for partial matches\n        if\
          \ relevance_score == 0:\n            for field in ['è¯¾ç¨‹åç§°', 'åŸ¹è®­å¯¹è±¡', 'åŸ¹è®­å¯¹è±¡1',\
          \ 'åŸ¹è®­è®²å¸ˆ', 'ç±»åˆ«']:\n                field_value = course.get(field, '').lower()\n\
          \                for keyword in query_keywords:\n                    if\
          \ keyword in field_value:\n                        relevance_score += 5\n\
          \                        break\n        \n        if relevance_score > 0:\n\
          \            relevant_courses.append((relevance_score, course))\n    \n\
          \    # If we found relevant courses, sort and return them\n    if relevant_courses:\n\
          \        relevant_courses.sort(key=lambda x: x[0], reverse=True)\n     \
          \   return [course for score, course in relevant_courses]\n    else:\n \
          \       # If no keyword matches, return all courses\n        return all_courses\n\
          \ndef create_llm_selection_prompt(courses: List[Dict], user_query: str)\
          \ -> str:\n    \"\"\"\n    Create a prompt for LLM to select 12 courses\
          \ for 12 months\n    \"\"\"\n    courses_json = json.dumps(courses, ensure_ascii=False,\
          \ indent=2)\n    \n    prompt = f\"\"\"\n# TRAINING COURSE SELECTION TASK\n\
          \n## USER QUERY:\n\"{user_query}\"\n\n## BACKGROUND:\nYou are an expert\
          \ training coordinator. Select 8-15 courses to create a balanced monthly\
          \ training plan. If fewer than 12 relevant courses exist, include the most\
          \ relevant ones available.\n\n## COURSE DATABASE:\n{courses_json}\n\n##\
          \ SELECTION CRITERIA:\n1. **RELEVANCE**: Match the user's query\n2. **MANDATORY\
          \ STATUS**: Prioritize courses with å¤‡æ³¨ containing \"å¿…ä¿®\", \"å¿…é¡»\", or \"\
          å¼ºåˆ¶\"\n3. **RECENCY**: Prefer 2023-2025 courses\n4. **VARIETY**: Ensure different\
          \ course types and trainers\n5. **BALANCE**: Distribute across different\
          \ months\n\n## OUTPUT REQUIREMENTS:\nReturn ONLY a valid markdown table\
          \ with 8-15 courses (or all available if fewer):\n\n| åºå· | æœˆä»½ | è¯¾ç¨‹åç§° | åŸ¹è®­è®²å¸ˆ\
          \ | è€ƒæ ¸ | è¯¾æ—¶ | åŸ¹è®­å¯¹è±¡ |\n|------|------|----------|----------|------|------|----------|\n\
          | original value | original value | original value | original value | original\
          \ value | original value | original value |\n| ...continue extracting and\
          \ filling the remaining rows with actual course data... |\n\n## IMPORTANT:\n\
          - PRESERVE ORIGINAL åºå· VALUES extracted from the metadata context - do not\
          \ renumber courses\n- Include all original field values exactly as provided\n\
          - Select 15 courses if available, or all relevant courses if fewer\n- Return\
          \ ONLY the markdown table, no explanations\n\"\"\"\n\n    return prompt\n\
          \ndef llm_final_selection(courses: List[Dict], query: str) -> str:\n   \
          \ \"\"\"\n    Select courses for 12-month plan, preserving original numbers\n\
          \    \"\"\"\n    print(f\"\U0001F4CA Processing {len(courses)} courses for\
          \ query: '{query}'\")\n    \n    # Prioritize courses while preserving original\
          \ data\n    prioritized = []\n    for course in courses:\n        score\
          \ = 0\n        \n        # Mandatory courses first\n        if any(keyword\
          \ in course.get('å¤‡æ³¨', '') for keyword in ['å¿…ä¿®', 'å¿…é¡»', 'å¼ºåˆ¶']):\n        \
          \    score += 100\n        \n        # Recent courses\n        if '2024'\
          \ in course.get('å¹´åº¦', '') or '2025' in course.get('å¹´åº¦', ''):\n         \
          \   score += 30\n        \n        # Department-specific\n        if course.get('åŸ¹è®­å¯¹è±¡1',\
          \ '') and course['åŸ¹è®­å¯¹è±¡1'] != '':\n            score += 20\n        \n  \
          \      # Query relevance\n        query_lower = query.lower()\n        for\
          \ field in ['è¯¾ç¨‹åç§°', 'åŸ¹è®­å¯¹è±¡', 'åŸ¹è®­å¯¹è±¡1', 'ç±»åˆ«']:\n            field_value = course.get(field,\
          \ '').lower()\n            if field_value and any(keyword in field_value\
          \ for keyword in query_lower.split()):\n                score += 15\n  \
          \              break\n        \n        prioritized.append((score, course))\n\
          \    \n    prioritized.sort(key=lambda x: x[0], reverse=True)\n    \n  \
          \  # Select up to 12 courses, but preserve all if fewer than 12\n    selected_courses\
          \ = [course for score, course in prioritized]\n    if len(selected_courses)\
          \ > 15:\n        selected_courses = selected_courses[:15]\n    \n    print(f\"\
          âœ… Selected {len(selected_courses)} courses for 12-month plan\")\n    \n\
          \    # Create Markdown table with ORIGINAL course numbers\n    markdown_lines\
          \ = []\n    markdown_lines.append(\"| åºå· | æœˆä»½ | è¯¾ç¨‹åç§° | åŸ¹è®­è®²å¸ˆ | è€ƒæ ¸ | è¯¾æ—¶ |\
          \ åŸ¹è®­å¯¹è±¡ |\")\n    markdown_lines.append(\"|------|------|----------|----------|------|------|----------|\"\
          )\n    \n    for course in selected_courses:\n        row = [\n        \
          \    course.get('åºå·', ''),\n            course.get('æœˆä»½', ''),\n        \
          \    course.get('è¯¾ç¨‹åç§°', ''),\n            course.get('åŸ¹è®­è®²å¸ˆ', ''),\n    \
          \        course.get('è€ƒæ ¸', ''),\n            course.get('è¯¾æ—¶', ''),\n    \
          \        course.get('åŸ¹è®­å¯¹è±¡', course.get('åŸ¹è®­å¯¹è±¡1', ''))\n        ]\n      \
          \  # Clean empty values but preserve original data\n        clean_row =\
          \ [str(item).strip() if item else '' for item in row]\n        markdown_lines.append(f\"\
          | {' | '.join(clean_row)} |\")\n    \n    return \"\\n\".join(markdown_lines)\n\
          \ndef create_monthly_plan_markdown(courses_markdown: str) -> str:\n    \"\
          \"\"\n    Create monthly distribution for the selected courses\n    \"\"\
          \"\n    # Parse the markdown to extract courses\n    lines = courses_markdown.strip().split('\\\
          n')\n    courses_data = []\n    \n    for line in lines[2:]:  # Skip header\
          \ lines\n        if line.startswith('|') and len(line.split('|')) > 3:\n\
          \            cells = [cell.strip() for cell in line.split('|')[1:-1]]\n\
          \            if len(cells) >= 8:\n                course_data = {\n    \
          \                'åºå·': cells[0],\n                    'æœˆä»½': cells[1],\n\
          \                    'è¯¾ç¨‹åç§°': cells[3]\n                }\n             \
          \   courses_data.append(course_data)\n    \n    # Distribute across 12 months\n\
          \    monthly_plan = {}\n    months = ['January', 'February', 'March', 'April',\
          \ 'May', 'June', \n              'July', 'August', 'September', 'October',\
          \ 'November', 'December']\n    \n    for i, course in enumerate(courses_data):\n\
          \        month_idx = i % 12\n        month_name = months[month_idx]\n  \
          \      if month_name not in monthly_plan:\n            monthly_plan[month_name]\
          \ = []\n        monthly_plan[month_name].append(course['è¯¾ç¨‹åç§°'])\n    \n\
          \    # Build output\n    output_lines = []\n    output_lines.append(\"#\
          \ \U0001F4C5 AIä¼˜åŒ–åŸ¹è®­è®¡åˆ’ (12ä¸ªæœˆ)\")\n    output_lines.append(\"\")\n    output_lines.append(\"\
          ## \U0001F3AF ç²¾é€‰è¯¾ç¨‹åˆ—è¡¨\")\n    output_lines.append(\"\")\n    output_lines.append(courses_markdown)\n\
          \    output_lines.append(\"\")\n    output_lines.append(\"## \U0001F4CA\
          \ æœˆåº¦åˆ†å¸ƒå»ºè®®\")\n    output_lines.append(\"\")\n    \n    for month in months:\n\
          \        if month in monthly_plan and monthly_plan[month]:\n           \
          \ output_lines.append(f\"### \U0001F4CD {month}\")\n            output_lines.append(\"\
          \")\n            for course_name in monthly_plan[month]:\n             \
          \   output_lines.append(f\"- {course_name}\")\n            output_lines.append(\"\
          \")\n    \n    output_lines.append(\"---\")\n    output_lines.append(f\"\
          âœ… åŸ¹è®­è®¡åˆ’ç”Ÿæˆå®Œæˆï¼å…± {len(courses_data)} é—¨è¯¾ç¨‹å¹³è¡¡åˆ†å¸ƒåœ¨12ä¸ªæœˆä¸­\")\n    \n    return \"\\\
          n\".join(output_lines)\n\ndef main(input_data: Union[Dict, List[Dict]],\
          \ query: str = None) -> dict:\n    \"\"\"\n    Main function that preserves\
          \ original course numbers and expands to 12-month plan\n    \"\"\"\n   \
          \ try:\n        # Handle input format\n        if isinstance(input_data,\
          \ dict):\n            metadata_list = [input_data]\n        elif isinstance(input_data,\
          \ list):\n            metadata_list = input_data\n        else:\n      \
          \      raise ValueError(f\"Unexpected input type: {type(input_data)}\")\n\
          \        \n        if not query:\n            query = \"æ‰€æœ‰åŸ¹è®­è¯¾ç¨‹\"\n     \
          \   \n        # Get all relevant courses\n        potential_courses = preprocess_and_filter_courses(metadata_list,\
          \ query)\n        \n        if not potential_courses:\n            return\
          \ {\"result\": \"âŒ æœªæ‰¾åˆ°åŒ¹é…çš„åŸ¹è®­è¯¾ç¨‹æ•°æ®ã€‚\"}\n        \n        # Select courses\
          \ for 12-month plan\n        markdown_output = llm_final_selection(potential_courses,\
          \ query)\n        \n        # Create final presentation\n        final_output\
          \ = create_monthly_plan_markdown(markdown_output)\n        \n        return\
          \ {\"result\": final_output}\n        \n    except Exception as e:\n   \
          \     return {\"result\": f\"âŒ é”™è¯¯: {str(e)}\"}"
        code_language: python3
        desc: ''
        outputs:
          result:
            children: null
            type: string
        selected: false
        title: Code 2
        type: code
        variables:
        - value_selector:
          - '1753251877701'
          - result
          value_type: array[object]
          variable: input_data
        - value_selector:
          - sys
          - query
          value_type: string
          variable: query
      height: 54
      id: '1755678692458'
      position:
        x: 2941
        y: 263
      positionAbsolute:
        x: 2941
        y: 263
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    viewport:
      x: -1884.7729330461598
      y: 74.50125452939
      zoom: 0.7140011265948383
